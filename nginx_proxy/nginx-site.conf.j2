server {
    listen      80;

    location /api/ {
      proxy_set_header Host $host:$server_port;
      proxy_set_header X-Real-IP $remote_addr;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

      client_body_temp_path     /tmp;
      client_body_buffer_size   521K;
      client_max_body_size      10G;

      {% if VIDEO_API_SERVICE_HOST is defined %}
      proxy_pass http://{{ VIDEO_API_SERVICE_HOST }}:8080;
      {% else %}
      proxy_pass http://video_api:8080/;
      {% endif %}
    }
}
